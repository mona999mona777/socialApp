import './polyfills.server.mjs';
import{a as Y,c as q,d as z,e as L,g as y,i as Z,k as J,l as K,n as X,o as ee,p as k}from"./chunk-ZWOSWUCK.mjs";import{a as ie}from"./chunk-DIKRYFYL.mjs";import{c as te,d as ne}from"./chunk-QYWQGVGL.mjs";import{a as W}from"./chunk-Y55FHL77.mjs";import{Ab as P,Bb as c,Cb as R,Db as b,Ib as O,Ka as U,Kb as p,Lb as u,Na as m,O as B,Sa as j,U as g,Y as M,ab as v,eb as S,ga as l,ha as d,ia as I,ib as w,ja as V,jb as A,kb as H,lb as o,mb as s,nb as C,nc as Q,ob as x,pb as h,qb as a,rc as G,ta as $,tb as E,ub as N,vb as T,yb as D,zb as F}from"./chunk-EGVBZG6N.mjs";import"./chunk-VVCT4QZE.mjs";var oe=(()=>{class i{constructor(){this._HttpClient=g(W)}createComment(e){return this._HttpClient.post(`${k.baseUrl}comments`,e)}getPostComment(e){return this._HttpClient.get(`${k.baseUrl}posts/${e}/comments`)}updateComment(e,t){return this._HttpClient.put(`${k.baseUrl}comments/${e}`,t)}deleteComment(e){return this._HttpClient.delete(`${k.baseUrl}comments/${e}`)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var se=["theComment"],ae=["Commentspage"],le=(i,_)=>_.id;function de(i,_){if(i&1){let e=x();o(0,"h3",4)(1,"h4"),c(2),p(3,"translate"),s(),o(4,"span",16),h("click",function(){l(e);let n=a();return d(n.closeComment(n.thePostid))}),C(5,"i",17),s()()}i&2&&(m(2),b("",u(3,1,"comment.No Comments")," ."))}function ce(i,_){if(i&1){let e=x();o(0,"h3",5)(1,"h4"),c(2),p(3,"translate"),s(),o(4,"span",16),h("click",function(){l(e);let n=a();return d(n.closeComment(n.thePostid))}),C(5,"i",17),s()()}i&2&&(m(2),b("",u(3,1,"comment.Newest"),":"))}function pe(i,_){if(i&1&&C(0,"img",19),i&2){let e=a().$implicit;N("alt","",e.commentCreator.name," profile"),S("src",e.commentCreator.photo,U)}}function ue(i,_){if(i&1){let e=x();o(0,"div",25,1)(2,"button",27),h("click",function(){l(e);let n=a().$implicit,r=a();return d(r.deleteComment(n.id))}),c(3),p(4,"translate"),s(),o(5,"button",28),h("click",function(){l(e);let n=a().$implicit,r=a();return d(r.updateComment(n))}),c(6),p(7,"translate"),s()()}if(i&2){let e=a().$implicit;E("id",e.id),m(3),b(" ",u(4,3,"comment.Delete")," "),m(3),b(" ",u(7,5,"comment.UpDate")," ")}}function Ce(i,_){if(i&1){let e=x();o(0,"div",6)(1,"div",18),v(2,pe,1,3,"img",19),o(3,"h3",20),c(4),s(),o(5,"span",21),c(6),p(7,"date"),s(),o(8,"div",22)(9,"span",23),h("click",function(){let n=l(e).$implicit,r=a();return d(r.thehidden(n.id))})("click",function(n){let r=l(e).$implicit,f=a();return d(f.dots(n,r.id))}),C(10,"i",24),s(),v(11,ue,8,7,"div",25),s()(),o(12,"p",26),c(13),s()()}if(i&2){let e=_.$implicit,t=a();m(2),w(2,e.commentCreator.photo?2:-1),m(2),b(" ",e.commentCreator.name," "),m(2),R(u(7,5,e.createdAt)),m(5),w(11,e.commentCreator._id==t.id?11:-1),m(2),R(e.content)}}function he(i,_){if(i&1){let e=x();o(0,"div",7)(1,"p"),c(2),p(3,"translate"),s(),o(4,"p")(5,"span",29),h("click",function(){l(e);let n=a();return d(n.closeerrormessg())}),C(6,"i",17),s()()()}i&2&&(m(2),b(" ",u(3,1,"comment.Sorry, The Post Owner Has Blocked You From Doing This.")," "))}var Pe=(()=>{class i{constructor(){this.id=localStorage.getItem("userid"),this._CommentsService=g(oe),this._PLATFORM_ID=g($),this._MytranslateService=g(ie),this._Renderer2=g(j),this.messageerror=!1,this.messageerr2="true",this.newestWord=!1,this.commentList=[],this.updateCommentGroup=new L({id:new y(null),contentUpdate:new y(null)})}ngOnInit(){G(this._PLATFORM_ID)&&localStorage.getItem("socialAppDarkMode")!=null&&this._Renderer2.addClass(document.documentElement,"dark"),G(this._PLATFORM_ID)&&localStorage.getItem("lang")!=null&&this._MytranslateService.useChoiceLang(),this.commentGroup=new L({content:new y(null),post:new y(this.postId)}),this.getPostComment()}getPostComment(){this.unsubgetPostComment=this._CommentsService.getPostComment(this.postId).subscribe({next:e=>{this.thePostid=this.postId,this.commentList=e.comments,e.total>0&&(this.newestWord=!0),e.total<=0&&(this.newestWord=!1)},error:e=>{console.log(e)}})}createComment(){this.unsubCreatComment=this._CommentsService.createComment(this.commentGroup.value).subscribe({next:e=>{this.commentList=e.comments,this.newestWord=!0,this.commentGroup.get("content")?.reset()},error:e=>{console.log(e)}})}deleteComment(e){this.unsubDeleteComment=this._CommentsService.deleteComment(e).subscribe({next:t=>{t.message=="success"&&(this.getPostComment(),this.commentGroup.get("content")?.reset())},error:t=>{console.log(t),t.error.message=="you are not allowed to perform this action."&&(this.messageerror=!0)}})}closeerrormessg(){this.messageerror=!1}updateComment(e){let t=document.getElementById("addform"),n=document.getElementById("updateform");this._Renderer2.removeClass(t,"flex"),this._Renderer2.addClass(t,"hidden"),this._Renderer2.removeClass(n,"hidden"),this._Renderer2.addClass(n,"flex"),this.updateCommentGroup.get("contentUpdate")?.setValue(e.content),this.updateCommentGroup.get("id")?.setValue(e.id)}UpdateComponentFun(){let{id:e,contentUpdate:t}=this.updateCommentGroup.value;this.unsubDeleteComment=this._CommentsService.updateComment(e,{content:t}).subscribe({next:n=>{if(n.message=="success"){this.getPostComment(),this.updateCommentGroup.get("contentUpdate")?.reset();let r=document.getElementById("addform"),f=document.getElementById("updateform");this._Renderer2.addClass(r,"flex"),this._Renderer2.removeClass(r,"hidden"),this._Renderer2.addClass(f,"hidden"),this._Renderer2.removeClass(f,"flex")}},error:n=>{console.log(n)}})}thehidden(e){let t=document.getElementById(e);this._Renderer2.removeClass(t,"hidden"),this._Renderer2.addClass(t,"absolute")}closehidden(e){e.target.classList.contains("fa-ellipsis")==!1&&this.theComment.forEach(n=>{n.nativeElement.classList.add("hidden")})}dots(e,t){e.target.classList.contains("fa-ellipsis")==!0&&this.theComment.forEach(r=>{r.nativeElement.id!=t&&r.nativeElement.classList.add("hidden")})}closeComment(e){this.Commentspage.forEach(t=>{t.nativeElement.id==e&&t.nativeElement.classList.contains("commentpage")&&this._Renderer2.addClass(t.nativeElement,"hidden")})}ngOnDestroy(){this.unsubCreatComment?.unsubscribe(),this.unsubgetPostComment?.unsubscribe(),this.unsubDeleteComment?.unsubscribe(),this.unsubUpdateComment?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=M({type:i,selectors:[["app-comments"]],viewQuery:function(t,n){if(t&1&&(D(se,5),D(ae,5)),t&2){let r;F(r=P())&&(n.theComment=r),F(r=P())&&(n.Commentspage=r)}},inputs:{postId:"postId"},standalone:!0,features:[O],decls:26,vars:20,consts:[["Commentspage",""],["theComment",""],[1,"flex","flex-col","p-1","commentpage",3,"click","id"],[1,"comment","flex","flex-col","overflow-x-hidden","border","border-gray-300","shadow-2xl","dark:bg-[#1C1C1D]","m-3","p-1"],[1,"text-lg","dark:text-gray-500","mx-3","text-center","pt-3","h-[100px]","flex","justify-between","items-center"],[1,"font-bold","text-lg","underline","dark:text-gray-300","mx-3","flex","justify-between","items-center"],[1,"bg-gray-200","rounded","my-2","p-5","relative","dark:bg-gray-700","dark:text-white","dark:border","dark:border-gray-500"],[1,"text-red-700","bg-red-100","border-red-200","border-4","rounded-lg","flex","justify-between","p-1","text-center"],["id","addform",1,"flex","items-center","px-3","py-2","bg-gray-50","dark:bg-[#1C1C1D]","dark:border-t","dark:border","dark:border-gray-600",3,"ngSubmit","formGroup"],["formControlName","content","id","chat","rows","1",1,"block","mx-4","p-2.5","w-full","text-sm","text-gray-900","bg-white","rounded-lg","border","border-gray-300","focus:ring-blue-500","focus:border-blue-500","dark:bg-[#1C1C1D]","dark:text-white",3,"placeholder"],["type","submit",1,"inline-flex","justify-center","p-2","text-blue-600","rounded-full","cursor-pointer","hover:bg-blue-100","dark:bg-[#1C1C1D]","dark:text-gray-500"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 18 20",1,"w-5","h-5","rotate-90","rtl:-rotate-90"],["d","m17.914 18.594-8-18a1 1 0 0 0-1.828 0l-8 18a1 1 0 0 0 1.157 1.376L8 18.281V9a1 1 0 0 1 2 0v9.281l6.758 1.689a1 1 0 0 0 1.156-1.376Z"],[1,"sr-only"],["id","updateform",1,"hidden","items-center","px-3","py-2","bg-gray-50","dark:bg-[#1C1C1D]","dark:border-t","dark:border","dark:border-gray-600",3,"ngSubmit","formGroup"],["formControlName","contentUpdate","id","chat","rows","1",1,"block","mx-4","p-2.5","w-full","text-sm","text-gray-900","bg-white","rounded-lg","border","border-gray-300","focus:ring-blue-500","focus:border-blue-500","dark:bg-[#1C1C1D]","dark:text-white",3,"placeholder"],[1,"border-white","border-2","p-1","hover:border-gray-300","dark:border-[#1C1C1D]","rounded-md",3,"click"],[1,"fa-solid","fa-xmark","fa-lg"],[1,"title","flex","items-center","gap-5"],[1,"w-10","h-10","rounded-full",3,"src","alt"],[1,"font-medium","dark:text-white"],[1,"font-light","text-gray-600","dark:text-gray-300"],[1,"menu","ms-auto"],[3,"click"],[1,"fa-solid","fa-ellipsis","mmm"],[1,"maro","hidden","overflow-hidden","rounded-lg","bg-slate-100","justify-center","items-center","dark:bg-[#1C1C1D]","ltr:top-0","ltr:right-0","rtl:left-0","rtl:top-0",3,"id"],[1,"text-gray-600","mt-4","dark:text-white"],["type","button",1,"dark:text-neutral-50","block","px-5","py-2",3,"click"],["type","button",1,"dark:text-neutral-50","block","px-4","py-2","border-t","border-black",3,"click"],[1,"border-rose-200","border-2","p-1","hover:border-red-600","rounded-md",3,"click"]],template:function(t,n){if(t&1){let r=x();o(0,"section",2,0),h("click",function(re){return l(r),d(n.closehidden(re))}),o(2,"div",3),v(3,de,6,3,"h3",4)(4,ce,6,3,"h3",5),A(5,Ce,14,7,"div",6,le),s(),v(7,he,7,3,"div",7),o(8,"form",8),h("ngSubmit",function(){return l(r),d(n.createComment())}),C(9,"textarea",9),p(10,"translate"),p(11,"translate"),o(12,"button",10),I(),o(13,"svg",11),C(14,"path",12),s(),V(),o(15,"span",13),c(16,"Send Comment"),s()()(),o(17,"form",14),h("ngSubmit",function(){return l(r),d(n.UpdateComponentFun())}),C(18,"textarea",15),p(19,"translate"),p(20,"translate"),o(21,"button",10),I(),o(22,"svg",11),C(23,"path",12),s(),V(),o(24,"span",13),c(25,"Send Comment"),s()()()()}t&2&&(E("id",n.thePostid),m(3),w(3,n.newestWord==!1&&n.commentList?3:-1),m(),w(4,n.newestWord==!0?4:-1),m(),H(n.commentList),m(2),w(7,n.messageerror?7:-1),m(),S("formGroup",n.commentGroup),m(),T("placeholder","",u(10,12,"comment.Your Comment"),", ",u(11,14,"comment.At Least 2 Char"),"."),m(8),S("formGroup",n.updateCommentGroup),m(),T("placeholder","",u(19,16,"comment.Your Comment"),", ",u(20,18,"comment.At Least 2 Char"),"."))},dependencies:[Q,ee,Z,Y,q,z,J,K,X,ne,te],styles:[".comment[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}"]})}}return i})();export{Pe as CommentsComponent};
